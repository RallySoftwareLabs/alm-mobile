define ->
  app = require 'application'
  utils = require 'lib/utils'
  PortfolioItems = require 'collections/portfolio_items'
  TypeDefinitions = require 'collections/type_definitions'

  class PortfolioItemModelFactory 
    getCollectionModel: (ordinal) ->
      piTypesFetchPromise = @fetchPortfolioItemTypes()
        piTypesFetchPromise.then =>
          new PortfolioItems(@piTypeDefinitions.findWhere({Ordinal: ordinal}))
      
    fetchPortfolioItemTypes: ->
        @piTypeDefinitions = new TypeDefinitions()
        @piTypeDefinitions.fetchAllPages
          data:
            fetch: 'ElementName,Ordinal'
            query: '(Parent.Name = "Portfolio Item")'
            order: 'Ordinal'